---
import Container from "../Container.astro";
import Altbau from "../icons/Altbau.astro";
import Beleuchtung from "../icons/Beleuchtung.astro";
import Check from "../icons/Check.astro";
import Neubau from "../icons/Neubau.astro";
import Notdienst from "../icons/Notdienst.astro";
import Sicherheit from "../icons/Sicherheit.astro";
import NoServiceFound from "./NoServiceFound.astro";
import ServiceCard from "./ServiceCard.astro";
---

<section class="bg-white py-10 md:py-40" id="leistungen">
  <Container>
    <div class="text-center">
      <h2>Wir bringen Licht ins Haus</h2>

      <p class="mt-4 text-base text-gray-700 sm:mt-8">
        Unsere Leistungen umfassen eine Vielzahl an Bereichen. Ihr Experte für
        Haustechnik und darüber hinaus.
      </p>
    </div>

    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-8 cards mt-8">
      <div class="hide">
        <ServiceCard
          text="Innenbeleuchtung, Außenbeleuchtung Lorem ipsum dolor, sit amet consectetur adipisicing elit. Explicabo sunt voluptatibus quia laboriosam magni voluptas quo culpa incidunt."
          title="Beleuchtung"
        >
          <Beleuchtung />
        </ServiceCard>
      </div>

      <div class="hide">
        <ServiceCard
          text="Lorem, ipsum dolor sit amet consectetur adipisicing elit. Inventore quisquam ab non dolorum esse temporibus placeat. Assumenda eligendi est facere"
          title="Neubau"
        >
          <Neubau />
        </ServiceCard>
      </div>

      <div class="hide">
        <ServiceCard
          text="Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellendus nostrum quasi, optio quisquam iusto, Et, pariatur placeat corrupti beatae rem perspiciatis, minus veniam ducimus laudantium, hic officiis. Beatae?"
          title="Sicherheit"
        >
          <Sicherheit />
        </ServiceCard>
      </div>

      <div class="hide">
        <ServiceCard
          text="Lorem, ipsum dolor sit amet consectetur adipisicing elit. Cumque soluta repellendus aspernatur dolor?"
          title="Altbau"
        >
          <Altbau />
        </ServiceCard>
      </div>

      <div class="hide">
        <ServiceCard
          text="Lorem ipsum, dolor sit amet consectetur adipisicing elit. Odio rem ut culpa impedit adipisci possimus dolore molestias nulla illum nisi."
          title="Geräteprüfung"
        >
          <Check />
        </ServiceCard>
      </div>

      <div class="hide">
        <ServiceCard
          text="Lorem ipsum dolor sit amet consectetur adipisicing elit. Asperiores officiis dignissimos labore facere harum quam."
          title="Notdienst"
        >
          <Notdienst />
        </ServiceCard>
      </div>
    </div>
    <NoServiceFound />
  </Container>
</section>

<script>
  const cardsContainer = document.querySelector<HTMLElement>(".cards");

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        entry.target
          .querySelectorAll<HTMLElement>(".hide")
          .forEach((c, idx) => {
            c.style.setProperty("--delay", `${idx * 200}ms`);

            if (entry.isIntersecting) c.classList.add("show");
          });
      });
    },
    {
      threshold: 0.05,
    }
  );

  if (cardsContainer) {
    observer.observe(cardsContainer);
  }
</script>

<style>
  .hide {
    @apply opacity-0 transition-all duration-500 ease-in-out blur-md scale-150 -translate-x-full delay-[var(--delay)] h-full;
  }

  .show {
    @apply opacity-100 transition-all duration-500 ease-in-out blur-none scale-100  -translate-x-0 delay-[var(--delay)];
  }
</style>
